<div [ngClass]="backgroundColor" class=" p-4 rounded-md col-span-1 border border-black dark:border-gray-600 dark:bg-gray-800">
  <h1 class="font-bold text-4xl text-center">{{pokemon.name |translatePokemonName |replaceDash | titlecase}}</h1>
  <h1 class="font-bold text-lg text-center">
    <span class="cursor-pointer" *ngIf="pokemonNameHirgana">{{pokemonNameHirgana.name | titlecase}}</span>
    <span *ngIf="pokemonNameRomaji">({{pokemonNameRomaji.name | titlecase}})</span>
  </h1>
  <div class="grid grid-cols-3 gap-1">
    <!-- Selector de tipo de imagen (solo si hay artes alternativos) -->
    <div class="col-span-3 flex justify-center" *ngIf="hasSugimoriArt || hasGlobalLinkArt">
      <div class="inline-flex rounded-md shadow-sm border border-gray-300 bg-white dark:bg-gray-800 dark:border-gray-600" role="group">
        <button
          type="button"
          class="px-3 py-1 text-sm font-medium rounded-l-md"
          [ngClass]="selectedImageType === 'home' ? 'bg-blue-600 text-white' : 'text-gray-900 bg-transparent dark:text-gray-200'"
          (click)="selectedImageType = 'home'; showShiny = false"
        >
          {{ language === 'es' ? 'Modelo Home' : 'Home Model' }}
        </button>
        <button
          *ngIf="hasSugimoriArt"
          type="button"
          class="px-3 py-1 text-sm font-medium"
          [ngClass]="selectedImageType === 'sugimoriArt' ? 'bg-blue-600 text-white' : 'text-gray-900 bg-transparent dark:text-gray-200'"
          (click)="selectedImageType = 'sugimoriArt'; showShiny = false"
        >
          Sugimori
        </button>
        <button
          *ngIf="hasGlobalLinkArt"
          type="button"
          class="px-3 py-1 text-sm font-medium rounded-r-md"
          [ngClass]="selectedImageType === 'globalLinkArt' ? 'bg-blue-600 text-white' : 'text-gray-900 bg-transparent dark:text-gray-200'"
          (click)="selectedImageType = 'globalLinkArt'; showShiny = false"
        >
          Global Link
        </button>
      </div>
    </div>

    <div class="col-span-3 flex justify-center">
      <!-- precarga -->
      <img [src]="getMainSprite()" style="display: none;">

      <!-- Modelo Home con toggle shiny -->
      <ng-container *ngIf="selectedImageType === 'home'; else altArtTemplate">
        <img
          class="w-80 hover:opacity-80 cursor-pointer"
          (click)="showShiny = true"
          *ngIf="!showShiny"
          [src]="pokemonSprite"
        >
        <img
          class="w-80 hover:opacity-80 cursor-pointer"
          (click)="showShiny = false"
          *ngIf="showShiny"
          [src]="pokemonSpriteShiny"
        >
      </ng-container>

      <!-- Artes alternativos (sin shiny) -->
      <ng-template #altArtTemplate>
        <img
          class="w-80 hover:opacity-80 cursor-pointer"
          [src]="getMainSprite()"
        >
      </ng-template>
    </div>
  </div>

  <div class="grid grid-cols-3 sm:grid-cols-5 gap-0 mt-2">
    <div class="col-span-3 sm:col-span-5 flex justify-center">
      <div [ngClass]="'gap-1 grid grid-cols-' + pokemon.types.length">
        <div *ngFor="let languageTypes of pokemontypes">
          <div *ngFor="let type of languageTypes">
            <div *ngIf="type.language === language" class="rounded-md text-center">
              <img class="w-32"
              [src]="'./assets/icons/types/' + type.typeName + '.png'">
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="flex justify-center mt-1">
    <div class="bg-white rounded-md border border-black p-3 dark:bg-gray-800 dark:border-gray-600">
      <div class="max-w-screen-sm">
        <div *ngFor="let abilityGroup of filteredAbilityNames">
          <div>
            <span class="font-bold">
              {{ language === 'es' ? 'Habilidad': 'Ability' }}
              <span routerLinkActive *ngIf="!abilityGroup.ability.is_hidden">{{ abilityGroup.ability.slot }}</span>
              <span *ngIf="abilityGroup.ability.is_hidden">{{ language === 'es' ? 'Oculta': 'Hidden' }}</span>:
            </span>
            <span class="hover:text-blue-500 cursor-pointer" [routerLink]="['/pokedex/show-ability', abilityGroup.ability.ability.name]" >{{ abilityGroup.name }}</span>
          </div>
        </div>
        <div *ngFor="let eggGroup of pokemonSpecie.egg_groups">
          <span class="font-bold">{{ language === 'es' ? 'Grupo Huevo': 'Egg Group' }}: </span>{{ getEggGroupName(eggGroup.name) }}
        </div>
        <h1><span class="font-bold">{{ language === 'es' ? 'Sexo': 'Sex' }}: </span>
          <span class="text-blue-400 cursor-pointer">{{ calculateGenderRateMale(pokemonSpecie.gender_rate) }}%</span> -
          <span class="text-pink-400 cursor-pointer">{{ calculateGenderRateFemale(pokemonSpecie.gender_rate) }}%</span>
        </h1>
        <h1><span class="font-bold">{{ language === 'es' ? 'Peso': 'Weight' }}: </span>{{ (pokemon.weight * 0.1).toFixed(1) }}kg</h1>
        <h1><span class="font-bold">{{ language === 'es' ? 'Altura': 'Heigth' }}: </span>{{ (pokemon.height*0.1).toFixed(1)  }}m</h1>
        <h1 class="font-bold" *ngIf="pokemonSpecie.is_legendary">Pokémon Legendario</h1>
        <h1 class="font-bold" *ngIf="pokemonSpecie.is_mythical">Pokémon Mitico</h1>
        <h1 class="font-bold" *ngIf="pokemonSpecie.is_baby">Pokémon Bebé</h1>
        <h1><span class="font-bold">{{ language === 'es' ? 'Generación': 'Generation' }}: </span>{{getGenerationName(pokemonSpecie.generation.name)}}</h1>
        <div *ngFor="let genera of pokemonSpecie.genera">
          <span *ngIf="genera.language.name === language"><span class="font-bold">{{ language === 'es' ? 'Categoria': 'Category' }}: </span>{{ genera.genus }} </span>
        </div>

        <app-pokemon-cry [pokemon]="pokemon" [language]="language"></app-pokemon-cry>

      </div>
    </div>
  </div>

</div>
